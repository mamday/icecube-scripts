import numpy

import matplotlib
matplotlib.use('Agg')
from matplotlib import pyplot
import pylab

#data_hist=numpy.array([[],
#[],
#[],
#[],
#[],
#[],
#[],
#[]])

#Th23=0.816 DM=0.00272 nuSQuIDS
data_hist=numpy.array([[   7.24,    8.53,   10.08,   13.28,   19.41,   25.62,   32.86,   45.29],
[  20.86,   24.26,   25.39,   27.72,   34.58,   41.32,   58.02,   75.31],
[  41.39,   45.89,   48.22,   48.61,   54.42,   56.88,   75.81,   96.71],
[  72.51,   80.78,   75.47,   70.96,   65.75,   66.6,    77.86,  102.43],
[102.28,  112.78,  109.28,   92.73,   86.39,   80.3,    73.08,   90.59],
[ 115.14,  131.84,  128.41,  113.5,   105.13,   86.1,    74.13,   86.09],
[ 134.8,   153.1,   155.6,   135.66,  126.31,  103.15,   92.09,   90.61],
[130.2,   160.24,  156.04,  149.04,  139.37,  120.76,   91.96,   97.22]])

#Th23=0.816 DM=0.00272 Vacuum 
#inj_hist = numpy.array([[   7.68,    9.01,   10.67,   14.12,   20.24,   26.57,   33.52,   44.85],  
#       [  22.04,   24.99,   26.32,   28.36,   35.47,   42.31,   59.09,   76.45],  
#       [  42.86,   46.56,   49.29,   49.86,   55.31,   58.79,   77.51,   98.02],  
#       [  73.77,   82.18,   76.13,   71.36,   66.43,   67.7 ,   79.64,  104.85],  
#       [ 102.87,  113.59,  109.88,   92.61,   86.25,   80.41,   73.54,   92.34],  
#       [ 114.79,  131.58,  128.07,  112.29,  104.  ,   85.  ,   73.67,   85.43],  
#       [ 133.63,  152.15,  154.45,  133.98,  124.08,  101.  ,   89.9 ,   88.13],  
#       [ 128.57,  158.35,  154.07,  147.09,  136.56,  118.86,   90.2 ,   94.7 ]])

#Th23=0.7 Vacuum
#inj_hist=numpy.array([[   7.6 ,    8.97,   10.63,   14.07,   20.2 ,   26.43,   33.48,   44.97],  
#       [  21.88,   24.83,   26.22,   28.35,   35.48,   42.36,   58.99,   76.56],  
#       [  42.47,   46.25,   49.16,   50.07,   55.5 ,   58.99,   77.62,   98.54],  
#       [  73.02,   81.6 ,   75.98,   71.59,   67.15,   68.43,   80.13,  105.95],  
#       [ 101.83,  112.58,  109.37,   92.97,   87.  ,   81.59,   74.8 ,   94.23],  
#       [ 113.53,  130.33,  127.27,  112.26,  104.71,   86.25,   75.31,   87.85],  
#       [ 132.08,  150.62,  153.21,  133.34,  124.04,  101.58,   90.8 ,   90.  ],  
#       [ 127.11,  156.6 ,  152.54,  145.97,  136.03,  118.74,   90.52,   95.48]])

#Th23=0.0 nuSQuIDS
#inj_hist=numpy.array([[   6.03,    8.07,   10.05,   13.24,   19.91,   24.27,   33.76,   49.01],
#[  18.83,   21.56,   24.57,   28.85,   36.87,   44.55,   58.79,   80.58],
#[  34.61,   39.9,    47.15,   55.63,   60.18,   65.42,   83.02,  112.37],
#[  57.29,   70.2,    73.36,   77.38,   83.49,   85.5,    93.67,  131.39],
#[  79.81,   92.44,  100.74,  100.62,  103.37,  107.27,  102.35,  135.74],
#[  86.88,  104.45,  110.92,  110.77,  117.63,  110.71,  109.56,  137.],
#[98.45,  117.28,  126.5 ,  119.1 ,  121.02,  110.94,  108.06,  125.47],
#[  93.98,  118.35,  118.95,  120.36,  121.7 ,  112.38,   93.88,  107.81]])

#Th23=0.58 nuSQuIDS
#inj_hist=numpy.array([[   6.89,    8.45,   10.04,   13.32,   19.69,   25.45,   33.25,   46.43],
#[  20.37,   23.57,   25.09,   28.1 ,   35.23,   42.38,   58.58,   76.96],
#[  39.85,   44.44,   47.98,   50.37,   55.94,   59.02,   77.72,  100.72],
#[  69.08,   78.41,   75.03,   72.33,   69.85,   70.91,   81.45,  109.09],
#[  97.26,  108.25,  107.34,   94.46,   90.05,   86.1 ,   79.47,  100.46],
#[ 108.84,  125.7 ,  124.5 ,  112.81,  107.73,   91.32,   81.71,   97.09],
#[ 126.71,  145.12,  149.09,  131.87,  124.97,  104.67,   95.38,   98.02],
#[ 122.15,  150.93,  147.78,  142.61,  135.32,  118.73,   92.22,   99.35]])

#Th23=0.7 nuSQuIDS
#inj_hist=numpy.array([[   7.13,    8.53,   10.05,   13.31,   19.56,   25.66,   33.04,   45.68],
#[  20.74,   24.08,   25.27,   27.86,   34.79,   41.71,   58.34,   75.89],
#[  41.07,   45.54,   48.17,   49.07,   54.85,   57.43,   76.35,   97.78],
#[  71.8,    80.3,    75.4,    71.2,    66.64,   67.51,   78.61,  103.87],
#[ 101.27,  111.88,  108.87,   93.06,   87.05,   81.34,   74.28,   92.45],
#[ 113.89,  130.6,  127.63,  113.32,  105.55,   87.,   75.47,   88.1 ],
#[133.2,  151.52,  154.29,  134.85,  125.96,  103.34,   92.61,   91.9],
#[ 128.61,  158.4,  154.4,  147.74,  138.5,  120.27,   91.93,   97.53]])

#MT=0.005
inj_hist = numpy.array([[   7.31,    8.64,   10.21,   13.43,   19.65,   26.05,   33.01,   45.28],
       [  21.05,   24.57,   25.7 ,   27.99,   34.95,   42.03,   58.98,   76.23],
       [  41.65,   45.99,   48.65,   48.72,   54.93,   57.92,   77.46,   99.46],
       [  72.99,   81.32,   75.41,   71.43,   66.05,   67.68,   79.48,  106.09],
       [ 103.21,  114.01,  109.9 ,   92.67,   86.58,   80.67,   74.4 ,   93.71],
       [ 115.92,  132.31,  128.45,  113.15,  104.06,   85.11,   73.73,   85.85],
       [ 135.69,  153.39,  156.04,  135.08,  124.6 ,  100.83,   89.77,   85.36],
       [ 131.02,  160.91,  156.16,  147.88,  137.38,  118.32,   88.48,   89.06]])

#MT=0.01
inj_hist1=numpy.array([[7.32,    8.68,   10.25,   13.47,   19.72,   26.25,   32.84,   44.53],
[ 21.07,   24.65,   25.82,   28.08,   35.04,   42.4,    58.96,   75.93],
[  41.58,   45.73,   48.81,   48.6,    55.05,   58.71,   78.42,  100.87],
[  72.96,   81.24,   74.76,   71.47,   66.41,   68.87,   81.15,  110.85],
[ 103.38,  114.46,  109.91,   92.27,   86.96,   81.89,   77.52,  101.73],
[ 115.99,  131.99,  127.65,  112.34,  103.05,   85.15,   76.28,   92.72],
[ 135.7,   152.8,   155.47,  133.5,   122.1,    98.47,   88.73,   85.77],
[ 130.98,  160.53,  155.25,  145.34,  133.98,  114.86,   84.55,   82.17]])

#Th23=1.0 nuSQuIDS
#inj_hist2=numpy.array([[   7.13,    8.4 ,   10.14,   13.18,   19.21,   25.08,   32.71,   45.51],
#[  20.52,   23.85,   25.42,   27.75,   34.82,   41.4 ,   57.48,   75.56],
#[  40.01,   44.85,   47.99,   49.76,   55.24,   58.28,   76.8 ,   99.1 ],
#[  69.35,   78.57,   74.99,   72.45,   69.25,   70.44,   81.11,  108.19],
#[  97.54,  108.46,  107.55,   94.46,   90.24,   86.39,   79.52,  100.49],
#[ 109.14,  126.09,  124.71,  113.06,  108.11,   91.79,   82.21,   97.47],
#[ 127.08,  145.5 ,  149.46,  132.32,  125.47,  105.19,   95.95,   98.62],
#[122.49,  151.32,  148.17,  143.03,  135.83,  119.28,   92.66,   99.87]])

#Th23=0.9 nuSQuIDS
#inj_hist2=numpy.array([[   7.23,    8.49,   10.11,   13.24,   19.31,   25.43,   32.77,   45.27],
#[  20.78,   24.17,   25.43,   27.7,    34.61,   41.26,   57.77,   75.26],
#[  41.,     45.63,   48.15,   48.89,   54.6,    57.22,   76.01,   97.26],
#[  71.62,   80.15,   75.33,   71.4,    66.7,    67.67,   78.77,  104.01],
#[ 100.94,  111.55,  108.8,    93.23,   87.52,   82.08,   74.94,   93.45],
#[ 113.43,  130.21,  127.36,  113.39,  106.02,   87.79,   76.51,   89.41],
#[ 132.6,   150.94,  153.86,  134.73,  126.11,  103.79,   93.26,   92.97],
#[ 128.,    157.7,   153.8,   147.35,  138.39,  120.39,   92.2,    98.03]])

#Th23=0.9 Vacuum
#inj_hist2 = numpy.array([[   7.6 ,    8.96,   10.66,   14.08,   20.25,   26.51,   33.62,   45.17],
#       [  21.88,   24.83,   26.27,   28.44,   35.62,   42.51,   59.17,   76.79],
#       [  42.44,   46.22,   49.23,   50.26,   55.63,   59.27,   77.96,   98.95],
#       [  72.84,   81.55,   76.  ,   71.77,   67.43,   68.77,   80.57,  106.4 ],
#       [ 101.55,  112.43,  109.45,   93.05,   87.22,   81.94,   75.18,   94.84],
#       [ 113.19,  130.05,  127.11,  112.15,  104.69,   86.36,   75.67,   88.22],
#       [ 131.58,  150.12,  152.82,  133.1 ,  123.8 ,  101.43,   90.83,   90.05],
#       [ 126.51,  156.  ,  152.01,  145.5 ,  135.56,  118.37,   90.3 ,   95.27]])

#MT=-0.005
inj_hist2 = numpy.array([[   7.13,    8.39,    9.89,   13.05,   19.02,   24.98,   32.37,   44.48],  
       [  20.54,   23.76,   24.92,   27.31,   33.95,   40.37,   56.23,   73.31],  
       [  40.83,   45.42,   47.55,   48.27,   53.57,   55.69,   73.73,   93.21],  
       [  71.55,   79.7 ,   74.97,   70.13,   65.54,   65.76,   76.5 ,  100.6 ],  
       [ 100.74,  110.92,  108.16,   92.56,   86.5 ,   80.88,   73.79,   92.97],  
       [ 113.73,  130.66,  127.63,  113.45,  106.24,   88.09,   77.4 ,   93.2 ],  
       [ 133.08,  151.96,  154.35,  135.33,  127.24,  105.28,   95.47,   99.99],  
       [ 128.59,  158.6 ,  154.95,  148.78,  139.91,  122.01,   94.49,  104.34]])

#MT=-0.01
inj_hist3=numpy.array([[   6.98,    8.23,    9.66,   12.79,   18.54,   24.23,   31.61,   43.05],
[  20.13,   23.16,   24.38,   26.8 ,   33.14,   39.3 ,   53.93,   70.67],
[  40.06,   44.66,   46.75,   47.76,   52.53,   54.49,   71.59,   89.78],
[ 70.3,    78.27,   74.05,   69.15,   65.54,   65.33,   75.63,  100.83],
[  98.86,  108.74,  106.8,    92.37,   87.05,   82.43,   76.44,   99.91],
[ 111.95,  129.02,  126.36,  113.18,  107.41,   90.9,    82.9,   105.05],
[130.75,  150.17,  152.63,  134.36,  127.54,  107.12,   99.46,  110.82],
[ 126.43,  156.23,  153.12,  147.31,  139.15,  122.09,   95.71,  108.45]])


#DM 0.002
inj_hist4=numpy.array([[  7.,      8.39,    9.56,   12.2,    18.27,   23.08,   30.43,   42.11],
[  20.6 ,   23.53,   25.13,   25.95,   30.53,   36.22,   51.4 ,   66.18],
[  39.98,   45.02,   47.97,   48.16,   49.56,   47.84,   63.47,   79.18],
[  70.63,   79.63,   76.71,   71.87,   65.95,   62.2,    65.35,   84.44],
[  98.28,  110.51,  111.17,   98.2,    92.23,   84.91,   74.46,   84.42],
[ 110.36,  129.05,  129.99,  120.8,  116.45,   98.31,   87.05,   97.78],
[ 128.62,  148.78,  154.99,  139.85,  135.12,  115.33,  105.64,  110.13],
[ 123.73,  153.87,  152.14,  148.99,  143.97,  128.13,  101.37,  110.82]])

#DM 0.004
inj_hist5=numpy.array([[   7.46,    8.64,   10.42,   13.96,   20.36,   25.58,   32.97,   44.41],
[  21.34,   24.65,   25.83,   29.8 ,   38.05,   44.47,   61.61,   74.67],
[  41.33,   45.36,   48.82,   50.17,   60.49,   64.66,   82.64,  106.67],
[  72.49,   80.43,   73.68,   70.99,   71.24,   74.49,   90.03,  118.52],
[ 103.9 ,  113.33,  106.55,   89.64,   86.9 ,   85.29,   81.83,  106.53],
[ 117.63,  131.83,  124.27,  106.01,   96.66,   81.1 ,   72.9 ,   90.22],
[ 137.87,  153.76,  152.41,  128.33,  115.52,   91.88,   81.84,   79.08],
[ 133.56,  162.66,  155.63,  144.41,  130.69,  110.49,   81.3 ,   83.74]])

diff_hist = data_hist-inj_hist
diff_hist1 = data_hist-inj_hist1
diff_hist2 = data_hist-inj_hist2
diff_hist3 = data_hist-inj_hist3
diff_hist4 = data_hist-inj_hist4
diff_hist5 = data_hist-inj_hist5

z_space = numpy.linspace(0,-1,9)
e_space = numpy.linspace(6,56,9)
z_bincent = numpy.zeros(8)
e_bincent = numpy.zeros(8)

for ind,val in enumerate(z_space):
  if val<0:
    #z_bincent[ind-1] = 0.5*(z_space[ind]+z_space[ind-1])
    #e_bincent[ind-1] = 0.5*(e_space[ind]+e_space[ind-1])
    z_bincent[ind-1] = z_space[ind-1]
    e_bincent[ind-1] = e_space[ind-1]
xx, yy = pylab.meshgrid(
z_space,
e_space
)
print z_bincent 
pylab.pcolor(xx,yy,diff_hist)
cbar = pylab.colorbar()
pylab.xlabel("Cos(zenith)")
pylab.ylabel("Energy (GeV)")
pylab.xlim(-1,0)
pylab.ylim(6,56)
cbar.set_label("#Events Difference from PRD")
pylab.clim(-10,10)
pylab.savefig("KinDiffTh23P7Plot.png")
pylab.close()
pylab.pcolor(xx,yy,diff_hist1)
cbar = pylab.colorbar()
pylab.xlabel("Cos(zenith)")
pylab.ylabel("Energy (GeV)")
pylab.xlim(-1,0)
pylab.ylim(6,56)
cbar.set_label("#Events Difference from PRD")
pylab.clim(-10,10)
pylab.savefig("KinDiffMTP01Plot.png")
pylab.close()
pylab.pcolor(xx,yy,diff_hist2)
cbar = pylab.colorbar()
pylab.clim(-10,10)
pylab.xlabel("Cos(zenith)")
pylab.ylabel("Energy (GeV)")
pylab.xlim(-1,0)
pylab.ylim(6,56)
cbar.set_label("#Events Difference from PRD")
pylab.savefig("KinDiffTh23P9Plot.png")
pylab.close()
pylab.pcolor(xx,yy,diff_hist3)
cbar = pylab.colorbar()
pylab.xlabel("Cos(zenith)")
pylab.ylabel("Energy (GeV)")
pylab.xlim(-1,0)
pylab.ylim(6,56)
cbar.set_label("#Events Difference from PRD")
pylab.clim(-10,10)
pylab.savefig("KinDiffMTMP01Plot.png")
pylab.close()
pylab.pcolor(xx,yy,diff_hist4)
cbar = pylab.colorbar()
pylab.xlabel("Cos(zenith)")
pylab.ylabel("Energy (GeV)")
pylab.xlim(-1,0)
pylab.ylim(6,56)
cbar.set_label("#Events Difference from PRD")
pylab.clim(-10,10)
pylab.savefig("KinDiffDM002Plot.png")
pylab.close()
pylab.pcolor(xx,yy,diff_hist5)
cbar = pylab.colorbar()
pylab.xlabel("Cos(zenith)")
pylab.ylabel("Energy (GeV)")
pylab.xlim(-1,0)
pylab.ylim(6,56)
cbar.set_label("#Events Difference from PRD")
pylab.clim(-10,10)
pylab.savefig("KinDiffDM0034Plot.png")
pylab.close()
